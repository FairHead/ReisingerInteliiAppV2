<?xml version="1.0" encoding="utf-8" ?>
<ContentView xmlns="http://schemas.microsoft.com/dotnet/2021/maui"
             xmlns:x="http://schemas.microsoft.com/winfx/2009/xaml"
             x:Class="ReisingerIntelliApp_V4.Controls.DevicePin"
             x:Name="Root">
    
    <Border x:Name="PinBorder"
            BackgroundColor="#007AFF"
            StrokeShape="RoundRectangle 20"
            StrokeThickness="2"
            Stroke="White"
            WidthRequest="40"
            HeightRequest="40"
            HorizontalOptions="Start"
            VerticalOptions="Start">
        
        <!-- Main Pin Content -->
        <Grid>
            <!-- Device Icon -->
            <Image x:Name="DeviceIcon"
                   Source="{Binding DeviceIconSource, Source={x:Reference Root}}"
                   WidthRequest="24"
                   HeightRequest="24"
                   HorizontalOptions="Center"
                   VerticalOptions="Center" />
            
            <!-- Action Buttons Overlay (initially hidden) -->
            <StackLayout x:Name="ActionPanel"
                         IsVisible="False"
                         Orientation="Horizontal"
                         HorizontalOptions="Center"
                         VerticalOptions="End"
                         Margin="0,0,0,-15"
                         Spacing="5">
                
                <!-- Door Control Button -->
                <Border BackgroundColor="#28A745"
                        StrokeShape="RoundRectangle 12"
                        StrokeThickness="0"
                        WidthRequest="24"
                        HeightRequest="24">
                    <Image Source="doordrive.svg"
                           WidthRequest="16"
                           HeightRequest="16"
                           HorizontalOptions="Center"
                           VerticalOptions="Center" />
                    <Border.GestureRecognizers>
                        <TapGestureRecognizer Tapped="OnDoorControlTapped" />
                    </Border.GestureRecognizers>
                </Border>
                
                <!-- Settings Button -->
                <Border BackgroundColor="#6C757D"
                        StrokeShape="RoundRectangle 12"
                        StrokeThickness="0"
                        WidthRequest="24"
                        HeightRequest="24">
                    <Image Source="settings.svg"
                           WidthRequest="16"
                           HeightRequest="16"
                           HorizontalOptions="Center"
                           VerticalOptions="Center" />
                    <Border.GestureRecognizers>
                        <TapGestureRecognizer Tapped="OnSettingsTapped" />
                    </Border.GestureRecognizers>
                </Border>
                
                <!-- Resize Button -->
                <Border BackgroundColor="#FFC107"
                        StrokeShape="RoundRectangle 12"
                        StrokeThickness="0"
                        WidthRequest="24"
                        HeightRequest="24">
                    <Label Text="âš"
                           FontSize="12"
                           TextColor="White"
                           HorizontalOptions="Center"
                           VerticalOptions="Center" />
                    <Border.GestureRecognizers>
                        <TapGestureRecognizer Tapped="OnResizeTapped" />
                    </Border.GestureRecognizers>
                </Border>
                
                <!-- Delete Button -->
                <Border BackgroundColor="#DC3545"
                        StrokeShape="RoundRectangle 12"
                        StrokeThickness="0"
                        WidthRequest="24"
                        HeightRequest="24">
                    <Image Source="deletedevicebutton.svg"
                           WidthRequest="16"
                           HeightRequest="16"
                           HorizontalOptions="Center"
                           VerticalOptions="Center" />
                    <Border.GestureRecognizers>
                        <TapGestureRecognizer Tapped="OnDeleteTapped" />
                    </Border.GestureRecognizers>
                </Border>
            </StackLayout>
        </Grid>
        
        <!-- Gesture Recognizers -->
        <Border.GestureRecognizers>
            <PanGestureRecognizer PanUpdated="OnPanUpdated" />
            <TapGestureRecognizer Tapped="OnPinTapped" />
        </Border.GestureRecognizers>
    </Border>
    
</ContentView>